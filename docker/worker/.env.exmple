# ==== Cluster Configuration ====
MASTER_ADDR=spark-01-mesh
MASTER_PORT=8000
RANK=1
WORLD_SIZE=2

# ==== Ray / NCCL / CUDA ====
RAY_MODE=worker
VLLM_HOST_IP=192.168.100.2
RAY_ADDRESS=192.168.100.1:6379

# ==== NCCL RDMA Configuration ====
# Use the ACTIVE verbs device on this host
NCCL_IB_HCA=roceP2p1s0f0
NCCL_IB_DISABLE=0
NCCL_SOCKET_IFNAME=enP2p1s0f0np0
NCCL_NET_PLUGIN=/opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so

# Debug settings
NCCL_DEBUG=INFO
NCCL_DEBUG_SUBSYS=INIT,NET,IB
NCCL_IB_GID_INDEX=0

# RDMA Performance Optimization
NCCL_NET_GDR_LEVEL=5    # Re-enabled GPUDirect RDMA
NCCL_IB_TC=106          # Traffic Class for QoS
NCCL_IB_SL=3            # Service Level for QoS
NCCL_IB_TIMEOUT=23      # Increased timeout for stability
NCCL_IB_RETRY_CNT=7     # Retry count for reliability

# Network Configuration
NCCL_CROSS_NIC=0        # Keep single-NIC path during bring-up

# ==== GPU visibility ====
NVIDIA_VISIBLE_DEVICES=all
NVIDIA_DRIVER_CAPABILITIES=compute,utility
RAY_VISIBLE_DEVICES=all
RAY_DISABLE_DOCKER_CPU_WARNING=1
RAY_EXPERIMENTAL_NOSET_CUDA_VISIBLE_DEVICES=1

# ==== Hugging Face ====
HF_HOME=/mnt/beegfs/shared/huggingface
HARMONY_ENCODINGS=/mnt/beegfs/shared/harmony
HUGGING_FACE_HUB_TOKEN=${HF_TOKEN}
TIKTOKEN_ENCODINGS_BASE=/etc/encodings

# ==== Performance (conservative baseline) ====
GPU_MEMORY_UTILIZATION=0.35
MAX_NUM_SEQS=16