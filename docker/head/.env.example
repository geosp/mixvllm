# ==== Cluster Configuration ====
MASTER_ADDR=spark-01-mesh
MASTER_PORT=8000
RANK=1
WORLD_SIZE=2

# ==== Ray / NCCL / CUDA ====
RAY_MODE=head
VLLM_HOST_IP=192.168.100.1
RAY_ADDRESS=192.168.100.1:6379

# ==== NCCL RDMA Configuration ====
# Use the ACTIVE verbs device (host shows roceP2p1s0f0 up)
NCCL_IB_HCA=roceP2p1s0f0
NCCL_IB_DISABLE=0
NCCL_SOCKET_IFNAME=enP2p1s0f0np0
NCCL_NET_PLUGIN=/opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so

# Debug settings
NCCL_DEBUG=INFO
NCCL_DEBUG_SUBSYS=INIT,NET,IB
NCCL_IB_GID_INDEX=0

# RDMA Performance Optimization
NCCL_NET_GDR_LEVEL=5    # Enabled GPUDirect RDMA
NCCL_IB_TC=106          # Traffic Class for QoS
NCCL_IB_SL=3            # Service Level for QoS
NCCL_IB_TIMEOUT=23      # Increased timeout for stability
NCCL_IB_RETRY_CNT=7     # Retry count for reliability

# Network Configuration
NCCL_CROSS_NIC=0        # Keep single-NIC path while bringing this up

# ==== GPU visibility ====
NVIDIA_VISIBLE_DEVICES=all
NVIDIA_DRIVER_CAPABILITIES=compute,utility
RAY_VISIBLE_DEVICES=all

# ==== Hugging Face ====
HF_HOME=/mnt/beegfs/shared/huggingface
HARMONY_ENCODINGS=/mnt/beegfs/shared/harmony/encodings
HUGGING_FACE_HUB_TOKEN=${HF_TOKEN}
TIKTOKEN_ENCODINGS_BASE=/etc/encodings

# ==== Model Selection ====
#MODEL_NAME=gpt-oss-20b
#MODEL_NAME=deepseek-r1-70b
MODEL_NAME=gpt-oss-120b
#MODEL_NAME=mixtral-8x7b